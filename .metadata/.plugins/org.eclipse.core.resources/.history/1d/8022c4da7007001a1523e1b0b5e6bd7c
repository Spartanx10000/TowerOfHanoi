package code;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.Vector;

import javax.swing.*;
import javax.swing.border.TitledBorder;
class Paso 
{
	public Torre A;
	public Torre B;

	public Paso(Torre a, Torre b)
	{
		A=a;
		B=b;
	}
}

public class Hanoi extends JPanel
{
	private static final long serialVersionUID = 1L;	
	ImageIcon ImagenFondo=new ImageIcon(Hanoi.class.getResource("/Images/Fondo.png"));
	ImageIcon Disco1=new ImageIcon(Hanoi.class.getResource("/Images/Disco1.png"));
    ImageIcon Disco2=new ImageIcon(Hanoi.class.getResource("/Images/Disco2.png"));
    ImageIcon Disco3=new ImageIcon(Hanoi.class.getResource("/Images/Disco3.png"));
    ImageIcon Disco4=new ImageIcon(Hanoi.class.getResource("/Images/Disco4.png"));
    ImageIcon Disco5=new ImageIcon(Hanoi.class.getResource("/Images/Disco5.png"));
    ImageIcon Disco6=new ImageIcon(Hanoi.class.getResource("/Images/Disco6.png"));
    ImageIcon Disco7=new ImageIcon(Hanoi.class.getResource("/Images/Disco7.png"));
    ImageIcon Disco8=new ImageIcon(Hanoi.class.getResource("/Images/Disco8.png"));
    ImageIcon Disco9=new ImageIcon(Hanoi.class.getResource("/Images/Disco9.png"));
    ImageIcon Disco10=new ImageIcon(Hanoi.class.getResource("/Images/Disco10.png"));
    ImageIcon imagen[] ={Disco1,Disco2,Disco3,Disco4,Disco5,Disco6,Disco7,Disco8,Disco9,Disco10};
	Vector<Paso> Bitácora = new Vector<Paso>();
	public int n,movimiento,i=0;
	private Torre izq, cen, der;
	boolean listo = false;
    Timer t1,t2,t3;////timers
    
	public Hanoi(int discos) ///constructor con el num. de discos
	{
		 setBorder(new TitledBorder(null, "Torres de hanoi - "+discos+" discos", TitledBorder.LEADING, TitledBorder.TOP, null, Color.CYAN));
		 
	     n = discos;
		 izq = new Torre(90,"A");///torre inicial
		 cen = new Torre(260,"B");///torre auxiliar
		 der = new Torre(430,"C");///torre destino
		 
		 movimiento = 0;
	     
		 for (int i = 0; i < n; i++)
	     {
	        izq.poste.push(imagen[i]);
	     }
	     cen.poste.setSize(0);
	     der.poste.setSize(0);
	     
	     Inicia();
	     
		t1 = new Timer(500, new ActionListener ()
		{
		    public void actionPerformed(ActionEvent e)
		    {  
		    	if(i!=movimiento)
				{
		    	 Bitácora.elementAt(i).A.cima=Bitácora.elementAt(i).A.poste.pop();
				 repaint();
				 t2.start(); 
				 t1.stop(); 
                }
				else
				{
				 listo=true;
				 repaint();
				 t1.stop();
				}
		    }
		});
		
		t2 = new Timer(500, new ActionListener ()
		{
		    public void actionPerformed(ActionEvent e)
		    {  
		    	Bitácora.elementAt(i).B.cima=Bitácora.elementAt(i).A.cima;
		    	Bitácora.elementAt(i).A.cima=null;
		    	repaint();
		    	t3.start();
		    	t2.stop();
		    }
		});
		
		t3 = new Timer(500, new ActionListener ()
		{
		    public void actionPerformed(ActionEvent e)
		    {  
		    	Bitácora.elementAt(i).B.poste.push(Bitácora.elementAt(i).B.cima);
		    	Bitácora.elementAt(i).B.cima=null;
		    	repaint();
		    	t3.stop();
		    	i++;
		    	t1.start();
		    }
		});	
		
		t1.start();
	}
	
	public void paintComponent(Graphics g) ///Método paint
	{
	   super.paintComponent(g);
       g.drawImage(ImagenFondo.getImage(),0,0,getWidth(),getHeight(),null);
       izq.dibuja(g);
       cen.dibuja(g);
       der.dibuja(g);
       izq.dibujaCima(g);
       cen.dibujaCima(g);
       der.dibujaCima(g);
       g.setColor(Color.blue);
       g.drawString("Movimiento: "+i, 10, 30);  
       if(listo)
       {
    	   g.setFont(new Font(null, Font.PLAIN, 20)); 
    	   g.setColor(Color.green);
           g.drawString("LISTO!!!",(getWidth()/2)-30, 40); 
       }
	}
	
	public void Inicia()/// Método de arranque de recursividad
	{
	  Recursivo(n, izq, cen, der);  
	}
 
	public void Recursivo(int n, Torre Inicial, Torre Central, Torre Final) ///Método recursivo de hanoi
	{
	    if(n==0)
	    {
	    	return;
	    }
	    else
	    {
	     Recursivo(n-1,Inicial,Final,Central);
	     movimiento++;
	     mover(Inicial,Final);
	     Recursivo(n-1,Central,Inicial,Final);
	   }
	}
    
	public void mover(Torre a, Torre b) 
    {
		Bitácora.addElement(new Paso(a,b));
	}
}